<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8" />
        <title>Water Mobile</title>
        <meta name="description" content="" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
        <!-- Cleartype for Windows Phone - uncomment below 1 line to apply-->
        <!--<meta http-equiv="cleartype" content="on">-->
		<link rel="stylesheet" href="css/circle.css" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/touch/apple-touch-icon-144x144-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/touch/apple-touch-icon-114x114-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/touch/apple-touch-icon-72x72-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" href="images/touch/apple-touch-icon-57x57-precomposed.png" />
        <link rel="shortcut icon" href="images/touch/apple-touch-icon.png" />

        <!-- Tile icon for Win8 (144x144 + tile color)  - uncomment below 2 lines to apply-->
        <!--<meta name="msapplication-TileImage" content="images/touch/apple-touch-icon-144x144-precomposed.png">-->
        <!--<meta name="msapplication-TileColor" content="#222222">-->


        <!-- For iOS web apps. Delete if not needed. https://github.com/h5bp/mobile-boilerplate/issues/94 -->
        <!--
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-title" content="">
        -->

        <!-- This script prevents links from opening in Mobile Safari. https://gist.github.com/1042026 -->
        <!--
        <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script>
        -->
        
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:100,200,300,400' rel='stylesheet' type='text/css' />
        <link href='http://fonts.googleapis.com/css?family=Josefin+Sans:100,300' rel='stylesheet' type='text/css' />
        

        <link rel="stylesheet" href="css/normalize.css" />
        <!--<link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css">-->
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.2.0.min.css" />
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
        <link rel="stylesheet" href="css/flexslider.css" />
        <link rel="stylesheet" href="css/photoswipe/photoswipe.css" />
        
        <link rel="stylesheet/less" href="css/main.css" />
        <script src="js/less-1.3.3.min.js"></script>
        
        
        <!--<script src="js/vendor/zepto.min.js"></script>-->

        <script src="js/jquery-1.8.2.min.js"></script>
        <script src="js/jquery.mobile-1.2.0.min.js"></script>
        <script src="js/helper.js"></script>
        <script src="js/jquery.flexslider-min.js"></script>
        <script src="js/photoswipe/klass.min.js"></script>
        <script src="js/photoswipe/code.photoswipe.jquery-3.0.5.min.js"></script>
        <script src="js/jquery.easyListSplitter.js"></script>
        <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
        
        <script src="js/forms.js"></script>
        <script src="js/main.js"></script>
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            var _gaq=[["_setAccount","UA-XXXXX-X"],["_trackPageview"]];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
            g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";
            s.parentNode.insertBefore(g,s)}(document,"script"));
        </script>
        
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
    <body class="my-body">
        <!-- Add your site or application content here -->
        <div id="about-page" class="page orange-page" data-theme="a" data-role="page">
            <div id="header" data-role="header">
                <div class="margpage">
                	<a href="index.html" data-role="none" data-transition="flip" class="left"><img src="images/rsz_back.png"/></a>
                    <a href="index.html" data-role="none" data-transition="flip" class="right"><img src="images/rsz_1home.png"/></a>
                    <h1>Start Order</h1>
                    
                </div>
            </div>
            <div class="margpage">
                <div>
                	 <div id="loading">
                		<div class="circle"></div>
						<div class="circle1"></div>
					</div>
                		<table style="width: 100%;">
                				<tr>
                					<td>Table No</td>
                					<td id="table_names"> </td>
                				</tr>
       
                				<tr>
                					<td>Name</td>
                					<td><input type="text" class="input theme-text" id="name" ></td>
                				</tr>
                				
                				<tr>
                					<td>No of People</td>
                					<td> <input type="text" id="noOfPeople" class="input theme-text"></td>
                				</tr>
                				
                				<tr>
                					<td >Mobile</td>
                					<td > <input type="text" id="tel" class="input theme-text" ></td>
                				</tr>
                				
                				
                				<tr>
                					<td >Date</td>
                					<td > <input type="date" id="date" class="input theme-text"></td>
                				</tr>
                				
                				<tr>
                					<td >Time</td>
                					<td > <input type="time" id="time" class="input theme-text"></td>
                				</tr>
                				
                				<tr>
                					<td> </td>
                					<td > <input type="button" class="button2" id="submit" onclick="set_order();" value="Start the Order" style="background-color: #45484D;" /> </td>
                				</tr>
                		</table>
                		<br/>
                </div>
            </div>
            
            <script>
            var local_name=window.localStorage.getItem("name");
            var local_tel=window.localStorage.getItem("tel");
            
              
            var output_table = $('#table_names');
            var order_id = window.localStorage.getItem("order_id");
            if(order_id != null){
            	//window.location = "gallery.html";
            	$.mobile.changePage( "gallery.html", {
  					transition: "flip",
  					role:"none",
  					reverse: false,
  					changeHash: true
				});
            }
            else{
            	document.getElementById("name").value=window.local_name;
            	document.getElementById("tel").value=window.local_tel;
            }
            
 			$.ajax({
				url: 'http://api-soulroll.friendlinet.com/get_rest_tables.php',
				dataType: 'jsonp',
				jsonp: 'jsoncallback',
				timeout: 50000000,
				success: function(data, status){
					var tables = '<select style"width: 100%;" class="noOfItems" id="table_select" class="input theme-text">'
								+'<option value="">Select Table</option>';
					$.each(data, function(i,item){ 
						tables = tables+ '<option value="'+item.tb_auto+'">'+item.table_name+'</option>';
					});
					tables = tables + '</select>';
					output_table.append(tables);
				},
				error: function(){
					output.text('There was an error loading the data.');
				}
			});
			
		function set_order(){
			if(validate()){
				document.getElementById("loading").style.display="block";
				var user_id = window.localStorage.getItem("user_id");
				var pass_table_id=document.getElementById("table_select").value;
				var name=document.getElementById("name").value;
				var noOfPeople=document.getElementById("noOfPeople").value;
				var tel=document.getElementById("tel").value;
				var date=document.getElementById("date").value;
				var time=document.getElementById("time").value;
			
   				if(order_id == null || order_id == ""){
					$.ajax({
					type: 'GET',
					url: 'http://api-soulroll.friendlinet.com/set_start_order.php',
					data: { table_no: pass_table_id, user_id: user_id,name:name,noOfPeople:noOfPeople,tel:tel,date:date,time:time}, 
					dataType: 'jsonp',
					jsonp: 'jsoncallback',
					timeout: 50000000,
					success: function(data, status){
						window.localStorage.setItem("table_no", pass_table_id);
						window.localStorage.setItem("order_id", data.order_id);
						window.localStorage.setItem("name", name);
						window.localStorage.setItem("tel", tel);
						//window.location = "gallery.html";
						$.mobile.changePage( "gallery.html", {
  							transition: "flip",
  							role:"none",
  							reverse: false,
  							changeHash: true
						});
						document.getElementById("loading").style.display="none";
					},
					error: function(){
						output.text('There was an error loading the data.');
					}
					});
				}
			}
		}
		
		 function validate(){
            var pass_table_id=document.getElementById("table_select");
			var name=document.getElementById("name");
			var noOfPeople=document.getElementById("noOfPeople");
			var tel=document.getElementById("tel");
			var date=document.getElementById("date");
			var time=document.getElementById("time");
            	
            if(pass_table_id.value == "")
            {
            	pass_table_id.focus();
            	pass_table_id.style.border="thin solid red";
            	return false;
            }
            else
            {
            	pass_table_id.style.border="0px";
            }
            
            if(name.value == "")
            {
            	name.focus();
            	name.style.border="thin solid red";
            	name.placeholder="Please enter your name.";
            	return false;
            }
            else
            {
            	name.style.border="0px";
            }
            
            if(noOfPeople.value == "")
            {
            	noOfPeople.focus();
            	noOfPeople.style.border="thin solid red";
            	noOfPeople.placeholder="Please enter the number of people.";
            	return false;
            }
            else
            {
            	noOfPeople.style.border="0px";
            }
            
            if(tel.value == "")
            {
            	tel.focus();
            	tel.style.border="thin solid red";
            	tel.placeholder="Please enter your mobile number.";
            	return false;
            }
            else
            {
            	tel.style.border="0px";
            }
            
            if(date.value == "")
            {
            	date.focus();
            	date.style.border="thin solid red";
            	date.placeholder="Please enter the reservation date.";
            	return false;
            }
            else
            {
            	date.style.border="0px";
            }
            
            if(time.value == "")
            {
            	time.focus();
            	time.style.border="thin solid red";
            	time.placeholder="Please enter the reservation time.";
            	return false;
            }
            else
            {
            	time.style.border="0px";
            }
            
            return true;
          }
		
            </script>
            
                        <div id="footer" class="footer">
                <div class="padpage group">
                    <div class="social left ">
                        
                    </div>
                    <div class="slogan right">
                         Designed @ ErbenLabs

                    </div>
                </div>
            </div>            
        
        </div>


        
        
    </body>
</html>
