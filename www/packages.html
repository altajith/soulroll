<!DOCTYPE html>
<!--[if IEMobile 7 ]>    <html class="no-js iem7"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8" />
        <title>Soul Roll 64</title>
        <meta name="description" content="" />
        <meta name="HandheldFriendly" content="True" />
        <meta name="MobileOptimized" content="320" />
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
        <!-- Cleartype for Windows Phone - uncomment below 1 line to apply-->
        <!--<meta http-equiv="cleartype" content="on">-->
		<link rel="stylesheet" href="css/circle.css" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="images/touch/apple-touch-icon-144x144-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/touch/apple-touch-icon-114x114-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/touch/apple-touch-icon-72x72-precomposed.png" />
        <link rel="apple-touch-icon-precomposed" href="images/touch/apple-touch-icon-57x57-precomposed.png" />
        <link rel="shortcut icon" href="images/touch/apple-touch-icon.png" />

        <!-- Tile icon for Win8 (144x144 + tile color)  - uncomment below 2 lines to apply-->
        <!--<meta name="msapplication-TileImage" content="images/touch/apple-touch-icon-144x144-precomposed.png">-->
        <!--<meta name="msapplication-TileColor" content="#222222">-->


        <!-- For iOS web apps. Delete if not needed. https://github.com/h5bp/mobile-boilerplate/issues/94 -->
        <!--
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="apple-mobile-web-app-title" content="">
        -->

        <!-- This script prevents links from opening in Mobile Safari. https://gist.github.com/1042026 -->
        <!--
        <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script>
        -->
        
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:100,200,300,400' rel='stylesheet' type='text/css' />
        <link href='http://fonts.googleapis.com/css?family=Josefin+Sans:100,300' rel='stylesheet' type='text/css' />
        

        <link rel="stylesheet" href="css/normalize.css" />
        <!--<link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css">-->
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.2.0.min.css" />
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
        <link rel="stylesheet" href="css/flexslider.css" />
        <link rel="stylesheet" href="css/photoswipe/photoswipe.css" />
        
        <link rel="stylesheet/less" href="css/main.css" />
        <script src="js/less-1.3.3.min.js"></script>
        
        
        <!--<script src="js/vendor/zepto.min.js"></script>-->

        <script src="js/jquery-1.8.2.min.js"></script>
        <script src="js/jquery.mobile-1.2.0.min.js"></script>
        <script src="js/helper.js"></script>
        <script src="js/jquery.flexslider-min.js"></script>
        <script src="js/photoswipe/klass.min.js"></script>
        <script src="js/photoswipe/code.photoswipe.jquery-3.0.5.min.js"></script>
        <script src="js/jquery.easyListSplitter.js"></script>
        <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
        
        <script src="js/forms.js"></script>
        <script src="js/main.js"></script>
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            var _gaq=[["_setAccount","UA-XXXXX-X"],["_trackPageview"]];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.async=1;
            g.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js";
            s.parentNode.insertBefore(g,s)}(document,"script"));
        </script>
        
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /></head>
    <body class="my-body">
        <!-- Add your site or application content here -->
        <div id="about-page" class="page orange-page" data-theme="a" data-role="page">
            <div id="header" data-role="header">
                <div class="margpage">
                    <!--<h2>Water</h2>-->
                    <h1>Packages</h1>
                    <a href="index.html" class="menu-button left"><</a>
                </div>
            </div>
            <div class="ui-body margpage">
                <div id="loading">
                	<div class="circle"></div>
					<div class="circle1"></div>
				</div>
                <div  id="pack_items">
                
                </div>
                
                 <div class="social left ">
                    	<input type="button" id="my_order_button" onclick="confirm_order();" class="button2" value="My Order" />
                       
                    </div>
                    <div class="slogan right">
                       <input type="button" id="place_button" onclick="place_order_func();" class="button2"  />
                    </div>
            </div>
            
 <script>
 	var validate_count=0;
 	var user_id = window.localStorage.getItem("user_id");
 	var order_id = window.localStorage.getItem("order_id");
 	
    if(order_id == null || order_id == ""){
  		window.location = "start-order.html";
    }
    
    var output = $('#pack_items');
	$.ajax({
		url: 'http://www.councilofcoders.com/phonegap/get_packages.php',
		dataType: 'jsonp',
		jsonp: 'jsoncallback',
		timeout: 5000,
		success: function(data, status){
			var menu = '<h3 class="border">Packages</h3>  <ul class="general">';
			$.each(data, function(i,item){
				if(item.additional_info == null){
					var additional="";
				}
				else
				{
					var additional=item.additional_info;
				}
				 menu = menu+' <li>'
                           + '<div class="content-box no-pad type-2">'
                            + '<div class="image"> <a onclick="setHref('+item.pack_id+');"><img style="width:100%; height:auto;" src="'+item.pack_image_path+'" /></a> </div>'
                             + '<a href="#" class="head group pad title">'+item.pack_name+'</a>'
                              + '<div class="content pad">'
                               +'<span>Package Type : '+item.pack_type+'</span><br/>'
                               +'<span>Package for : '+item.package_size+' people</span><br/>'
                               +'<span>'+additional+'</span>'
                               + '<div id="items_out'+item.pack_id+'"><span><b>Items</b></span><br/> </div>'
                               +'</div>'
                               + '<div class="group foot"> '
                               +'<a class="left highlight">$'+item.price+'</a>'
                               + '<a target="_blank" class="right highlight" id="add_to_cart_button'+item.pack_id+'" onclick="package_add_to_order('+item.pack_id+');" >Add to order</a>' 
                               + '<a target="_blank" class="left highlight"> '+item.available_meal+'</a>'      
                               + '</div> </div>'
                          +' </li>';
						
                         get_menu_items_per_package(item.pack_id);
                         check_item_available_in_cart(item.pack_id);
			});
			menu=menu+'</ul>';
			output.append(menu);       
		},
		error: function(){
			output.text('There was an error loading the data.');
		}
	});
	
	function check_item_available_in_cart(pack_id){
		document.getElementById("loading").style.display="block";
		$.ajax({
			type: 'GET',
			url: 'http://www.councilofcoders.com/phonegap/check_package_cart.php',
			data: { pack_id: pack_id, user_id: window.user_id}, 
			dataType: 'jsonp',
			jsonp: 'jsoncallback',
			timeout: 50000000,
			success: function(data, status){
				if(data.res == "1")
				{
					document.getElementById('add_to_cart_button' + pack_id).onclick=function(){ package_remove_from_order(pack_id); };
					document.getElementById('add_to_cart_button' + pack_id).innerHTML="Remove";
					document.getElementById('add_to_cart_button' + pack_id).style.backgroundColor="red";
					validate_count++;
				}
				document.getElementById("loading").style.display="none";
			},
			error: function(){
				output.text('There was an error loading the data.');
			}
		});
	}
	
	
    function package_add_to_order(pack_id){
    	document.getElementById("loading").style.display="block";
    	$.ajax({
			type: 'GET',
			url: 'http://www.councilofcoders.com/phonegap/add_to_package_cart.php',
			data: {pack_id: pack_id, user_id:window.user_id}, 
			dataType: 'jsonp',
			jsonp: 'jsoncallback',
			timeout: 5000,
			success: function(data, status){
 				if(data.res == "1"){
					alert("Added to the order.");
					document.getElementById('add_to_cart_button' + pack_id).onclick=function(){ package_remove_from_order(pack_id); };
					document.getElementById('add_to_cart_button' + pack_id).innerHTML="Remove";
					document.getElementById('add_to_cart_button' + pack_id).style.backgroundColor="red";
					validate_count++;
				}
				document.getElementById("loading").style.display="none";
			},
			error: function(){
				output.text('There was an error loading the data.');
			}
		});
   	} 
   	
   	function package_remove_from_order(pack_id){
   		document.getElementById("loading").style.display="block";
    	$.ajax({
			type: 'GET',
			url: 'http://www.councilofcoders.com/phonegap/remove_from_package_cart.php',
			data: {pack_id: pack_id, user_id:window.user_id}, 
			dataType: 'jsonp',
			jsonp: 'jsoncallback',
			timeout: 5000,
			success: function(data, status){
 				if(data.res == "1"){
					alert("Removed from the order.");
					document.getElementById('add_to_cart_button' + pack_id).onclick=function(){ package_add_to_order(pack_id); };
					document.getElementById('add_to_cart_button' + pack_id).innerHTML="Add to order";
					document.getElementById('add_to_cart_button' + pack_id).style.backgroundColor="";
					validate_count++;
				}
				document.getElementById("loading").style.display="none";
			},
			error: function(){
				output.text('There was an error loading the data.');
			}
		});
   	} 
     
    
    function setHref(val_id){
       window.location = "package-detail.html?pack_id="+val_id;
    }
    
    function setHref_Item(val_id){
       window.location = "gallery-detail.html?item_id="+val_id;
    }
    
	function get_menu_items_per_package(pass_pack_id){
		
		var pack_id = pass_pack_id;
		$.ajax({
		type: 'GET',
		url: 'http://www.councilofcoders.com/phonegap/get_menu_items_per_pack.php',
		data: {pack_id: pack_id}, 
		dataType: 'jsonp',
		jsonp: 'jsoncallback',
		timeout: 5000,
		success: function(data, status){
 			var items_out = $('#items_out'+pack_id);
			$.each(data, function(i,item){
				var item_html='<a href="#" onclick="setHref_Item('+item.item_id+');" ><span>'+(i+1)+' : '+item.item_name+'</span></a><br/>';
	
				items_out.append(item_html);       
			});
			
		},
		error: function(){
			output.text('There was an error loading the data.');
		}
	});
	}
	
	
	function confirm_order(){
		window.location ="services.html";
	}
	
			
	function place_order_func(){
		var place_order = window.localStorage.getItem("place_order");
		document.getElementById("loading").style.display="block";
		if(window.validate_count != 0){
			if(place_order == "true")
			{
				document.getElementById("place_button").value="Order is placed.";
				document.getElementById("place_button").disabled=true;
				
			}
			else
			{
				window.localStorage.setItem("place_order", "true");
				$.ajax({
					type: 'GET',
					url: 'http://www.councilofcoders.com/phonegap/cart_to_kitchen.php',
					data: { user_id: window.user_id, order_id: window.order_id}, 
					dataType: 'jsonp',
					jsonp: 'jsoncallback',
					timeout: 50000000,
					success: function(data, status){
						window.location = "services.html";
						document.getElementById("loading").style.display="none";
					},
					error: function(){
						output.text('There was an error loading the data.');
					}
				});
			}
		}
		else
		{
			alert("You have to select at least one item.");
		}
	}
 </script>
                        <div id="footer" class="footer">
                <div class="padpage group">
                    <div class="social left ">
                    	 Designed @ ErbenLabs

                    </div>
                    <div class="slogan right">
                    </div>
                </div>
            </div>            
           <script>
            	  
    	var place_order = window.localStorage.getItem("place_order");
    	
		if(place_order == "true")
		{
			document.getElementById("place_button").value="Order is placed";
			document.getElementById("place_button").disabled=true;
		}
		else
		{
			document.getElementById("place_button").value="Place your Order";
		}
	
            </script>   
        </div>


        
        
    </body>
</html>
